/*! unityping - v0.1.0 - 2019-07-10
* Copyright (c) 2019 Jinyoung Kim; Licensed MIT */
!function(a){"use strict";var b=function(b,c){this.jq=a(b),this.options=a.extend({},a.fn.unityping.defaults,c),this.beginCode={han:44032,cho:4352},this.jamo={cho:["ㄱ","ㄲ","ㄴ","ㄷ","ㄸ","ㄹ","ㅁ","ㅂ","ㅃ","ㅅ","ㅆ","ㅇ","ㅈ","ㅉ","ㅊ","ㅋ","ㅌ","ㅍ","ㅎ"],jung:["ㅏ","ㅐ","ㅑ","ㅒ","ㅓ","ㅔ","ㅕ","ㅖ","ㅗ","ㅘ","ㅙ","ㅚ","ㅛ","ㅜ","ㅝ","ㅞ","ㅟ","ㅠ","ㅡ","ㅢ","ㅣ"],jong:["","ㄱ","ㄲ","ㄳ","ㄴ","ㄵ","ㄶ","ㄷ","ㄹ","ㄺ","ㄻ","ㄼ","ㄽ","ㄾ","ㄿ","ㅀ","ㅁ","ㅂ","ㅄ","ㅅ","ㅆ","ㅇ","ㅈ","ㅊ","ㅋ","ㅌ","ㅍ","ㅎ"]},this.pos={str:0,ch:0,sentence:0},this.written=this.jq.text(),this.sq=[],this.run()};b.prototype={construction:b,init:function(){for(var a=this,b=0,c=a.options.string.length;b<c;b++)a.sq.push(a.sequencer(a.options.string[b])),a.sq[b].tplen=function(){for(var c=0,d=0;d<a.sq[b].length;d++)c+=a.sq[b][d].length;return c}();setTimeout(function(){a.typing(a.sq[a.pos.sentence])},this.options.startDelay)},typing:function(a){var b=this,c=function(){var a=50;return 6e4/(Math.random()*a-.5*a+b.options.typingSpeed)}();setTimeout(function(){if(b.pos.str===a.length)return b.pos.sentence===b.options.string.length-1?void b.options.onComplete():void setTimeout(function(){b.backspace(a)},b.options.backDelay);console.log(a[b.pos.str][0]),b.written=b.pos.ch?b.written.substr(0,b.written.length-1)+a[b.pos.str][b.pos.ch]:b.written+a[b.pos.str][b.pos.ch],b.jq.html(b.written),b.options.eachTyping(b.written,b.pos),b.pos.ch!==a[b.pos.str].length-1?b.pos.ch++:(b.pos.str++,b.pos.ch=0),b.typing(a)},c)},backspace:function(a){var b=this,c=b.options.string.length;setTimeout(function(){if(!b.pos.str)return void(b.pos.sentence!==c-1&&(b.pos.sentence++,setTimeout(function(){b.typing(b.sq[b.pos.sentence])},b.options.startDelay)));b.written=b.written.substr(0,b.written.length-1),b.jq.text(b.written),b.options.eachBack(b.written,b.pos.sentence),b.pos.str--,b.backspace(a)},b.options.backSpeed)},run:function(){this.addCursor("box"),this.init()},addCursor:function(b,c){if("box"===b){this.jq.after('<span id="blinker"></span>');var d=parseInt(this.jq.css("font-size")),e=.92*d+"px",f=.13*d+"px";a("#blinker").css({"background-color":"#ffffff",position:"relative",display:"inline-block",width:"1px",height:e,top:f,left:"-1px"})}"text"===b&&(this.jq.after('<span id="blinker">'+c+"</span>"),a("#blinker").css({"font-weight":100,"font-size":1.14*parseInt(this.jq.css("font-size"))+"px"}))},sequencer:function(a){for(var b=this,c=function(a){var c=[],d=function(a,c,d){return d=d||0,void 0!==c||d?String.fromCharCode(b.beginCode.han+28*(21*a+c)+d):String.fromCharCode(b.beginCode.cho+a)},e=b.jamo;return c.push(d(a.cho)),a.jung>e.jung.indexOf("ㅗ")&&a.jung<e.jung.indexOf("ㅛ")?c.push(d(a.cho,e.jung.indexOf("ㅗ"))):a.jung>e.jung.indexOf("ㅜ")&&a.jung<e.jung.indexOf("ㅠ")?c.push(d(a.cho,e.jung.indexOf("ㅜ"))):a.jung>e.jung.indexOf("ㅡ")&&a.jung<e.jung.indexOf("ㅣ")&&c.push(d(a.cho,e.jung.indexOf("ㅡ"))),c.push(d(a.cho,a.jung)),a.jong&&(a.jong>e.jong.indexOf("ㄲ")&&a.jong<e.jong.indexOf("ㄴ")?c.push(d(a.cho,a.jung,e.jong.indexOf("ㄱ"))):a.jong>e.jong.indexOf("ㄴ")&&a.jong<e.jong.indexOf("ㄷ")?c.push(d(a.cho,a.jung,e.jong.indexOf("ㄴ"))):a.jong>e.jong.indexOf("ㄹ")&&a.jong<e.jong.indexOf("ㅁ")?c.push(d(a.cho,a.jung,e.jong.indexOf("ㄹ"))):a.jong>e.jong.indexOf("ㅂ")&&a.jong<e.jong.indexOf("ㅅ")&&c.push(d(a.cho,a.jung,e.jong.indexOf("ㅂ"))),c.push(d(a.cho,a.jung,a.jong))),c},d=function(a){if(!/[ㄱ-ㅎ|ㅏ-ㅣ|가-힣]/.test(a))switch(a){case"\n":return["<br>"];default:return[a]}var d=a.charCodeAt(0)-b.beginCode.han,e={};return e.jong=d%28,e.jung=(d-e.jong)/28%21,e.cho=((d-e.jong)/28-e.jung)/21,c(e)},e=[],f=0;f<a.length;f++){var g=d(a[f]);e.push(g)}return e}},a.fn.unityping=function(c){return this.each(function(){a(this).data("unityping",new b(this,c))})},a.fn.unityping.defaults={string:["안녕하세요!","원하시는 문장을 쓰시면,","이렇게 타이핑이 됩니다!"],typingSpeed:200,startDelay:0,backDelay:1e3,backSpeed:100,cursor:"|",eachTyping:function(){},eachBack:function(){},onComplete:function(){}}}(window.jQuery);